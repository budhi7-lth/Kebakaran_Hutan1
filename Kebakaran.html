<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Edukatif Kebakaran Hutan</title>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.4.0/lib/p5.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    
    <script type="module" src="https://unpkg.com/@splinetool/viewer@1.10.7/build/spline-viewer.js"></script>

    <style>
        /* Styling Global Body dan Reset CSS */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            /* Memberikan warna background dasar jika Spline tidak termuat atau disabled */
            background: linear-gradient(135deg, #2c5530, #4a7c59); 
            color: #333;
            overflow-x: hidden; /* Sembunyikan overflow horizontal */
            display: flex;
            flex-direction: column;
            min-height: 100vh; /* Tinggi minimal 100% viewport */
            position: relative;
        }

        /* Spline Viewer sebagai Background 3D */
        spline-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* Mengirim Spline ke lapisan paling belakang */
            opacity: 0.7; /* Mengurangi opasitas agar tidak terlalu dominan */
            filter: blur(3px); /* Menambahkan efek blur agar detailnya berkurang dan tidak mengganggu */
            transition: opacity 0.5s ease, filter 0.5s ease; /* Transisi untuk perubahan visual */
        }

        /* Header Utama */
        .header {
            background: linear-gradient(90deg, #1a3a2e, #16423c);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            position: relative; /* Pastikan di atas spline-viewer */
            z-index: 1;
        }

        .header h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        /* Navigasi Tombol Panel */
        .navigation {
            background: #2d4a32;
            padding: 15px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            position: relative;
            z-index: 1;
        }

        .nav-btn {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            background: linear-gradient(45deg, #f7931e, #ff6b35);
        }

        .nav-btn.active {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            transform: scale(1.05);
        }

        /* Kontainer untuk Panel Isi */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            flex-grow: 1;
            position: relative;
            z-index: 1; /* Pastikan di atas spline-viewer */
        }

        /* Styling Umum Panel */
        .panel {
            display: none;
            background: white; /* Pastikan panel memiliki latar belakang solid agar konten jelas */
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: fadeIn 0.5s ease-in;
        }

        .panel.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .panel h2 {
            font-family: 'Poppins', sans-serif;
            color: #2c5530;
            font-size: 2.2em;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 3px solid #ff6b35;
            padding-bottom: 10px;
        }

        /* Area Simulasi dalam Panel */
        .simulation-area {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            border: 2px solid #e9ecef;
            position: relative;
            min-height: 400px;
        }

        /* Panel 1: Segitiga Api */
        .fire-triangle {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 300px;
            position: relative;
        }

        .triangle-element {
            position: absolute;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.1em;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border: 3px solid rgba(255,255,255,0.5);
        }

        .triangle-element:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
        }

        .heat { background: linear-gradient(45deg, #ff4757, #ff3742); top: 20px; left: 50%; transform: translateX(-50%); }
        .fuel { background: linear-gradient(45deg, #8b4513, #a0522d); bottom: 20px; left: 20%; }
        .oxygen { background: linear-gradient(45deg, #3742fa, #2f3542); bottom: 20px; right: 20%; }

        .fire-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #ff6b35, #e74c3c);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            animation: flicker 1s infinite alternate;
            transition: all 0.5s ease;
        }

        @keyframes flicker {
            0% { box-shadow: 0 0 20px #ff6b35; }
            100% { box-shadow: 0 0 40px #e74c3c, 0 0 60px #ff6b35; }
        }

        .fire-center.extinguished {
            background: #95a5a6;
            animation: none;
            box-shadow: none;
            font-size: 1.5em;
        }

        /* Panel 2: Penyebab Kebakaran */
        .causes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .cause-item {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 2px solid rgba(255,255,255,0.5);
        }

        .cause-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #0984e3, #74b9ff);
        }

        .cause-item .icon {
            font-size: 3em;
            margin-bottom: 10px;
            display: block;
        }

        /* Panel 3: Penyebaran Api */
        .forest-grid {
            display: grid;
            grid-template-columns: repeat(15, 1fr);
            gap: 2px;
            margin: 20px auto;
            max-width: 480px;
            border: 2px solid #333;
            border-radius: 5px;
            overflow: hidden;
        }

        .forest-cell {
            width: 30px;
            height: 30px;
            background: #27ae60;
            border-radius: 3px;
            transition: all 0.5s ease;
            position: relative;
        }

        .forest-cell.burning {
            background: linear-gradient(45deg, #e74c3c, #ff6b35);
            animation: burn 0.5s infinite alternate;
        }

        .forest-cell.burnt {
            background: #2c3e50;
        }

        @keyframes burn {
            0% { box-shadow: 0 0 5px #e74c3c; }
            100% { box-shadow: 0 0 15px #ff6b35, 0 0 25px #e74c3c; }
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
            padding: 20px;
            background: #ecf0f1;
            border-radius: 15px;
            flex-direction: row; /* Default for larger screens */
        }
        /* Penempatan ulang tombol reset di dalam controls */
        .controls .control-button-reset {
            margin-top: 0; /* Hapus margin atas jika di dalam controls */
        }

        @media (max-width: 768px) {
            .controls {
                flex-direction: column; /* Stack vertically on small screens */
            }
        }

        .control-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .control-item label {
            font-weight: bold;
            color: #2c3e50;
        }

        .slider {
            width: 150px;
            height: 5px;
            border-radius: 5px;
            background: #bdc3c7;
            outline: none;
            cursor: pointer;
            -webkit-appearance: none;
            appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #e74c3c;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .fire-size-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 10px;
            font-weight: bold;
            z-index: 10;
        }

        .wind-arrow {
            position: absolute;
            font-size: 2.5em;
            color: #74b9ff;
            transition: transform 0.3s ease;
            top: 20px;
            left: 20px;
            line-height: 1;
            transform-origin: center center;
        }

        .progress-bar {
            width: 80%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            margin: 10px auto;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #e74c3c, #ff6b35);
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }

        /* Panel 4: Dampak Kebakaran */
        .damage-scene {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .damage-item {
            background: linear-gradient(135deg, #636e72, #2d3436);
            color: white;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 2px solid rgba(255,255,255,0.5);
        }

        .damage-item:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        .damage-item .icon {
            font-size: 3em;
            margin-bottom: 10px;
            display: block;
        }

        /* Panel 5: Pemadaman */
        .firefighting-tools {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .tool-item {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            padding: 25px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 2px solid rgba(255,255,255,0.5);
        }

        .tool-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #00a085, #00b894);
        }

        .tool-item .icon {
            font-size: 3em;
            margin-bottom: 15px;
            display: block;
        }

        /* Panel 6: Mitigasi */
        .mitigation-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }

        .mitigation-type {
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
            color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 2px solid rgba(255,255,255,0.5);
        }

        .mitigation-type h3 {
            font-size: 1.8em;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 10px;
        }

        .mitigation-items {
            display: grid;
            gap: 15px;
        }

        .mitigation-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .mitigation-item:hover {
            background: rgba(255,255,255,0.2);
            transform: translateX(10px);
        }

        .mitigation-item .icon {
            font-size: 1.5em;
            margin-right: 10px;
            display: inline-block;
            vertical-align: middle;
        }

        /* Panel 7: Rangkuman */
        .recovery-timeline {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            padding: 20px;
            background: linear-gradient(90deg, #ff7675, #fdcb6e, #6c5ce7, #00b894);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .timeline-stage {
            text-align: center;
            color: white;
            font-weight: bold;
            padding: 15px;
            border-radius: 10px;
            background: rgba(0,0,0,0.2);
            backdrop-filter: blur(5px);
            flex: 1;
            margin: 0 5px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .timeline-stage:hover {
            transform: scale(1.05);
            background: rgba(0,0,0,0.4);
        }

        .timeline-stage .icon {
            font-size: 2.5em;
            display: block;
            margin-bottom: 10px;
        }

        /* Kotak Informasi Umum */
        .info-text {
            background: #e8f6f3;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #00b894;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .warning-text {
            background: #fef5e7;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #f39c12;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .success-text {
            background: #eafaf1;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #27ae60;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .interactive-note {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        /* Tooltip */
        .tooltip {
            position: absolute;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.9em;
            max-width: 200px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none; /* Agar tidak menghalangi klik */
        }

        .tooltip.show {
            opacity: 1;
        }

        /* Media Queries untuk Responsivitas */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            .header p {
                font-size: 1em;
            }
            .navigation {
                flex-direction: column;
                align-items: center;
            }
            .nav-btn {
                width: 90%; /* Tombol memenuhi lebar */
            }
            .panel {
                padding: 20px;
            }
            .panel h2 {
                font-size: 1.8em;
            }
            .simulation-area {
                padding: 20px;
                min-height: 300px;
            }
            .fire-triangle {
                height: 250px;
            }
            .triangle-element {
                width: 90px;
                height: 90px;
                font-size: 0.9em;
            }
            .fire-center {
                width: 60px;
                height: 60px;
                font-size: 1.5em;
            }
            .causes-grid, .damage-scene, .firefighting-tools, .mitigation-section {
                grid-template-columns: 1fr; /* Kolom tumpuk */
            }
            .controls {
                flex-direction: column;
            }
            .slider {
                width: 100%;
            }
            .recovery-timeline {
                flex-direction: column;
                gap: 15px;
            }
            .timeline-stage {
                width: 90%;
            }
        }
    </style>
</head>
<body>
    <spline-viewer url="https://prod.spline.design/eduRh80FRsINSgXS/scene.splinecode"></spline-viewer>

    <div class="header">
        <h1>🔥 Simulasi Mitigasi Kebakaran Hutan 🌲</h1>
        <p>Media Edukasi Interaktif untuk Memahami Kebakaran Hutan dan Upaya Mitigasinya</p>
    </div>

    <div class="navigation">
        <button class="nav-btn active" onclick="showPanel(1)">1. Segitiga Api</button>
        <button class="nav-btn" onclick="showPanel(2)">2. Penyebab</button>
        <button class="nav-btn" onclick="showPanel(3)">3. Penyebaran</button>
        <button class="nav-btn" onclick="showPanel(4)">4. Dampak</button>
        <button class="nav-btn" onclick="showPanel(5)">5. Pemadaman</button>
        <button class="nav-btn" onclick="showPanel(6)">6. Mitigasi</button>
        <button class="nav-btn" onclick="showPanel(7)">7. Rangkuman</button>
    </div>

    <div class="container">
        <div class="panel active" id="panel1">
            <h2>🔥 Panel 1: Apa Itu Api? - Segitiga Api</h2>
            
            <div class="info-text">
                <strong>Konsep Segitiga Api:</strong> Api hanya dapat menyala jika tiga unsur dasar tersedia secara bersamaan: <strong>Panas, Bahan Bakar, dan Oksigen</strong>. Jika salah satu unsur dihilangkan, api akan padam. Konsep ini adalah dasar dari semua strategi pemadaman kebakaran.
            </div>

            <div class="simulation-area">
                <div class="interactive-note">
                    💡 Klik salah satu elemen untuk melihat efeknya terhadap api di tengah
                </div>
                
                <div class="fire-triangle">
                    <div class="triangle-element heat" onclick="toggleElement('heat')" data-tooltip="PANAS: Energi yang dibutuhkan untuk memulai dan mempertahankan proses pembakaran. Contoh: Percikan api, sinar matahari terik.">
                        🌡️<br>PANAS
                    </div>
                    <div class="triangle-element fuel" onclick="toggleElement('fuel')" data-tooltip="BAHAN BAKAR: Material yang dapat terbakar seperti daun kering, ranting, rumput, pohon, atau gambut.">
                        🌿<br>BAHAN BAKAR
                    </div>
                    <div class="triangle-element oxygen" onclick="toggleElement('oxygen')" data-tooltip="OKSIGEN: Gas yang diperlukan untuk proses pembakaran berlangsung, umumnya dari udara di sekitar.">
                        💨<br>OKSIGEN
                    </div>
                    <div class="fire-center" id="fireCenter">🔥</div>
                </div>

                <div id="triangleExplanation" class="warning-text" style="display: none;">
                    <strong>Elemen yang dihilangkan:</strong> <span id="removedElement"></span><br>
                    <strong>Akibat:</strong> Api padam karena salah satu unsur penting tidak tersedia.
                </div>
            </div>

            <div class="success-text">
                <strong>Penerapan dalam Pemadaman:</strong><br>
                • <strong>Menghilangkan Panas:</strong> Menyemprotkan air untuk menurunkan suhu hingga di bawah titik bakar.<br>
                • <strong>Menghilangkan Bahan Bakar:</strong> Membuat sekat bakar (firebreak) atau membersihkan area dari material mudah terbakar agar api tidak memiliki bahan untuk menyebar.<br>
                • <strong>Menghilangkan Oksigen:</strong> Menggunakan busa pemadam atau karbon dioksida untuk mengisolasi api dari udara, sehingga pembakaran tidak dapat berlanjut.
            </div>
        </div>

        <div class="panel" id="panel2">
            <h2>⚡ Panel 2: Penyebab Kebakaran Hutan</h2>
            
            <div class="info-text">
                Kebakaran hutan dapat disebabkan oleh faktor alam maupun aktivitas manusia. Memahami penyebab-penyebab ini sangat penting untuk merancang upaya pencegahan yang efektif.
            </div>

            <div class="simulation-area">
                <div class="interactive-note">
                    🎯 Klik ikon di bawah untuk mempelajari berbagai penyebab kebakaran hutan
                </div>
                
                <div class="causes-grid">
                    <div class="cause-item" onclick="showCause('lightning')">
                        <span class="icon">⚡</span>
                        <h4>Sambaran Petir</h4>
                        <p>Faktor Alam</p>
                    </div>
                    <div class="cause-item" onclick="showCause('cigarette')">
                        <span class="icon">🚬</span>
                        <h4>Puntung Rokok</h4>
                        <p>Kelalaian Manusia</p>
                    </div>
                    <div class="cause-item" onclick="showCause('campfire')">
                        <span class="icon">🔥</span>
                        <h4>Api Unggun</h4>
                        <p>Kelalaian Manusia</p>
                    </div>
                    <div class="cause-item" onclick="showCause('burning')">
                        <span class="icon">🌾</span>
                        <h4>Pembakaran Lahan</h4>
                        <p>Aktivitas Manusia</p>
                    </div>
                    <div class="cause-item" onclick="showCause('electrical')">
                        <span class="icon">🔌</span>
                        <h4>Korsleting Listrik</h4>
                        <p>Kelalaian/Kerusakan</p>
                    </div>
                    <div class="cause-item" onclick="showCause('vehicle')">
                        <span class="icon">🚗</span>
                        <h4>Kendaraan Panas</h4>
                        <p>Kelalaian/Kerusakan</p>
                    </div>
                </div>

                <div id="causeExplanation" class="warning-text" style="display: none;">
                    <div id="causeContent"></div>
                </div>
            </div>

            <div class="info-text">
                <strong>Statistik Penyebab Umum:</strong><br>
                • <strong>Faktor Manusia:</strong> Diperkirakan 85-90% dari kebakaran hutan di seluruh dunia disebabkan oleh aktivitas manusia, baik disengaja maupun karena kelalaian.<br>
                • <strong>Faktor Alam:</strong> Hanya sekitar 10-15% kebakaran hutan yang disebabkan oleh faktor alam seperti sambaran petir.<br>
                • <strong>Pencegahan Kunci:</strong> Sebagian besar kebakaran akibat aktivitas manusia sebenarnya dapat dicegah dengan meningkatkan kesadaran, kehati-hatian, dan penegakan peraturan.
            </div>
        </div>

        <div class="panel" id="panel3">
            <h2>🌬️ Panel 3: Proses Penyebaran Kebakaran</h2>
            
            <div class="info-text">
                Penyebaran kebakaran hutan adalah proses dinamis yang sangat dipengaruhi oleh tiga faktor utama lingkungan: <strong>kecepatan angin, tingkat kelembaban, dan suhu udara</strong>. Simulasi ini akan menunjukkan bagaimana perubahan pada kondisi lingkungan ini mempengaruhi pola dan kecepatan penyebaran api.
            </div>

            <div class="simulation-area">
                <div class="controls">
                    <div class="control-item">
                        <label for="windSpeed">🌬️ Kecepatan Angin</label>
                        <input type="range" id="windSpeed" class="slider" min="0" max="100" value="20" oninput="updateFireSpread()">
                        <span id="windValue">Sedang (20%)</span>
                    </div>
                    <div class="control-item">
                        <label for="humidity">💧 Kelembaban</label>
                        <input type="range" id="humidity" class="slider" min="0" max="100" value="60" oninput="updateFireSpread()">
                        <span id="humidityValue">Normal (60%)</span>
                    </div>
                    <div class="control-item">
                        <label for="temperature">🌡️ Suhu</label>
                        <input type="range" id="temperature" class="slider" min="0" max="100" value="40" oninput="updateFireSpread()">
                        <span id="temperatureValue">Sedang (40°C)</span>
                    </div>
                    <button onclick="resetForest()" class="control-button-reset" style="padding: 15px 30px; background: #27ae60; color: white; border: none; border-radius: 25px; font-size: 1.1em; cursor: pointer;">
                        🔄 Reset Simulasi
                    </button>
                </div>

                <div class="interactive-note">
                    🎮 Geser slider di atas untuk melihat pengaruhnya terhadap penyebaran api di peta hutan. Api akan menyebar dari tengah.
                </div>
                
                <div class="fire-size-indicator" id="fireSizeIndicator">
                    Ukuran Api: <span id="fireSize">Kecil</span>
                </div>
                
                <div class="wind-arrow" id="windArrow">➡️</div>

                <div class="forest-grid" id="forestGrid">
                    </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="spreadProgress"></div>
                </div>
                <p style="text-align: center; margin-top: 10px;">
                    <strong>Tingkat Penyebaran: <span id="spreadRate">Normal</span></strong>
                </p>
            </div>

            <div class="warning-text">
                <strong>Faktor-faktor Kunci Penyebaran:</strong><br>
                • <strong>Angin Kencang:</strong> Mempercepat laju penyebaran api dan membawa percikan api ke area yang lebih jauh, menciptakan titik api baru.<br>
                • <strong>Kelembaban Rendah:</strong> Membuat vegetasi (bahan bakar) menjadi sangat kering dan lebih mudah terbakar, serta mempercepat proses pembakaran.<br>
                • <strong>Suhu Tinggi:</strong> Mengeringkan bahan bakar lebih cepat, meningkatkan intensitas api, dan mempercepat proses pra-pemanasan vegetasi di depan api.<br>
                • <strong>Topografi:</strong> Api cenderung menyebar lebih cepat menanjak bukit karena panas dari api naik ke atas, memanaskan vegetasi di lereng di atasnya.
            </div>
        </div>

        <div class="panel" id="panel4">
            <h2>🌍 Panel 4: Dampak Kebakaran Hutan</h2>
            
            <div class="info-text">
                Kebakaran hutan memiliki dampak yang luas, mulai dari kerusakan ekosistem yang tak ternilai hingga masalah kesehatan masyarakat dan kerugian ekonomi. Namun, dalam beberapa kasus ekologis yang sangat spesifik, api juga memiliki peran alami dalam siklus kehidupan hutan.
            </div>

            <div class="simulation-area">
                <div class="interactive-note">
                    🔍 Klik setiap dampak untuk mempelajari penjelasan detailnya.
                </div>
                
                <h3 style="color: #e74c3c; text-align: center; margin-bottom: 20px;">🚨 Dampak Negatif</h3>
                <div class="damage-scene">
                    <div class="damage-item" onclick="showDamage('biodiversity')">
                        <span class="icon">🦋</span>
                        <h4>Kehilangan Keanekaragaman Hayati</h4>
                        <p>Kepunahan spesies</p>
                    </div>
                    <div class="damage-item" onclick="showDamage('air')">
                        <span class="icon">😷</span>
                        <h4>Polusi Udara</h4>
                        <p>Kabut asap berbahaya</p>
                    </div>
                    <div class="damage-item" onclick="showDamage('health')">
                        <span class="icon">🏥</span>
                        <h4>Masalah Kesehatan</h4>
                        <p>Gangguan pernapasan</p>
                    </div>
                    <div class="damage-item" onclick="showDamage('economic')">
                        <span class="icon">💰</span>
                        <h4>Kerugian Ekonomi</h4>
                        <p>Sektor pariwisata & pertanian</p>
                    </div>
                    <div class="damage-item" onclick="showDamage('climate')">
                        <span class="icon">🌡️</span>
                        <h4>Perubahan Iklim</h4>
                        <p>Peningkatan emisi karbon</p>
                    </div>
                    <div class="damage-item" onclick="showDamage('soil')">
                        <span class="icon">🌱</span>
                        <h4>Kerusakan Tanah</h4>
                        <p>Erosi & Kesuburan</p>
                    </div>
                </div>

                <h3 style="color: #27ae60; text-align: center; margin: 30px 0 20px 0;">✅ Dampak Positif (Ekologis Alami)</h3>
                <div class="damage-scene">
                    <div class="damage-item" style="background: linear-gradient(135deg, #27ae60, #2ecc71);" onclick="showDamage('regeneration')">
                        <span class="icon">🌱</span>
                        <h4>Regenerasi Tumbuhan</h4>
                        <p>Benih tertentu aktif</p>
                    </div>
                    <div class="damage-item" style="background: linear-gradient(135deg, #27ae60, #2ecc71);" onclick="showDamage('nutrients')">
                        <span class="icon">🌿</span>
                        <h4>Siklus Nutrisi</h4>
                        <p>Abu kembalikan mineral</p>
                    </div>
                    <div class="damage-item" style="background: linear-gradient(135deg, #27ae60, #2ecc71);" onclick="showDamage('diversity')">
                        <span class="icon">🦎</span>
                        <h4>Peningkatan Keanekaragaman</h4>
                        <p>Habitat baru</p>
                    </div>
                </div>

                <div id="damageExplanation" class="warning-text" style="display: none;">
                    <div id="damageContent"></div>
                </div>
            </div>

            <div class="warning-text">
                <strong>Penting untuk Diingat:</strong><br>
                Meskipun kebakaran memiliki peran ekologis alami dalam beberapa ekosistem tertentu (terutama yang secara historis terpapar api), kebakaran yang disebabkan aktivitas manusia, terutama di ekosistem tropis seperti Indonesia, umumnya bersifat <strong>destruktif, tidak terkendali, dan menyebabkan kerugian jauh lebih besar</strong> daripada manfaatnya. Fokus utama harus tetap pada pencegahan dan pengendalian kebakaran yang tidak diinginkan.
            </div>
        </div>

        <div class="panel" id="panel5">
            <h2>🚒 Panel 5: Cara Memadamkan Kebakaran Hutan</h2>
            
            <div class="info-text">
                Pemadaman kebakaran hutan adalah tugas yang menantang dan membutuhkan kombinasi strategi darat serta udara. Setiap metode memiliki kelebihan dan keterbatasan yang berbeda tergantung pada kondisi dan skala kebakaran.
            </div>

            <div class="simulation-area">
                <div class="interactive-note">
                    🚁 Klik setiap alat pemadaman di bawah untuk melihat cara kerjanya dalam mengurangi intensitas api.
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="fireExtinguishProgress" style="background: linear-gradient(90deg, #e74c3c, #c0392b);"></div>
                </div>
                <p style="text-align: center; margin: 10px 0;">
                    <strong>Intensitas Api: <span id="fireIntensityDisplay">100%</span></strong>
                </p>

                <div class="firefighting-tools">
                    <div class="tool-item" onclick="useFireTool('ground')">
                        <span class="icon">🚒</span>
                        <h4>Tim Darat</h4>
                        <p>Mobil pemadam & petugas lapangan</p>
                        <small>Efektivitas: Sedang, Jangkauan: Terbatas</small>
                    </div>
                    <div class="tool-item" onclick="useFireTool('helicopter')">
                        <span class="icon">🚁</span>
                        <h4>Helikopter Water Bombing</h4>
                        <p>Penyemprotan air dari udara</p>
                        <small>Efektivitas: Tinggi, Jangkauan: Luas</small>
                    </div>
                    <div class="tool-item" onclick="useFireTool('firebreak')">
                        <span class="icon">🛤️</span>
                        <h4>Sekat Bakar</h4>
                        <p>Membuat jalur kosong tanpa bahan bakar</p>
                        <small>Efektivitas: Tinggi, Pencegahan: Excellent</small>
                    </div>
                    <div class="tool-item" onclick="useFireTool('foam')">
                        <span class="icon">🧴</span>
                        <h4>Busa Pemadam</h4>
                        <p>Mengisolasi api dari oksigen</p>
                        <small>Efektivitas: Sangat Tinggi, Area: Terbatas</small>
                    </div>
                    <div class="tool-item" onclick="useFireTool('backburn')">
                        <span class="icon">🔥</span>
                        <h4>Pembakaran Terkendali</h4>
                        <p>Membakar bahan bakar di depan api utama</p>
                        <small>Efektivitas: Tinggi, Risiko: Tinggi</small>
                    </div>
                    <div class="tool-item" onclick="useFireTool('chemical')">
                        <span class="icon">💧</span>
                        <h4>Retardant Kimia</h4>
                        <p>Bahan kimia penghambat api</p>
                        <small>Efektivitas: Tinggi, Durasi: Lama</small>
                    </div>
                </div>

                <div id="toolExplanation" class="success-text" style="display: none;">
                    <div id="toolContent"></div>
                </div>

                <button onclick="resetFire()" style="display: block; margin: 20px auto; padding: 15px 30px; background: #e74c3c; color: white; border: none; border-radius: 25px; font-size: 1.1em; cursor: pointer;">
                    🔥 Reset Api (Simulasi Kebakaran Baru)
                </button>
            </div>

            <div class="info-text">
                <strong>Strategi Pemadaman Terpadu:</strong><br>
                • <strong>Fase 1: Deteksi Dini & Respons Cepat:</strong> Menemukan api secepat mungkin dan mengirim tim darat untuk pemadaman awal.<br>
                • <strong>Fase 2: Serangan Udara:</strong> Menggunakan helikopter atau pesawat untuk *water bombing* di area yang luas atau sulit dijangkau.<br>
                • <strong>Fase 3: Pengendalian & Pencegahan Penyebaran:</strong> Membuat sekat bakar (firebreak) atau menggunakan *backburn* untuk menghentikan laju api.<br>
                • <strong>Fase 4: Pemadaman Total & Monitoring:</strong> Memastikan api benar-benar padam hingga ke titik panas terkecil dan memantau area untuk mencegah kebakaran susulan.
            </div>
        </div>

        <div class="panel" id="panel6">
            <h2>🛡️ Panel 6: Upaya Mitigasi Bencana Kebakaran Hutan</h2>
            
            <div class="info-text">
                Mitigasi kebakaran hutan adalah upaya komprehensif untuk mengurangi risiko dan dampak bencana, baik sebelum maupun sesudah kejadian. Upaya ini dibagi menjadi dua kategori utama: <strong>struktural (infrastruktur fisik)</strong> dan <strong>non-struktural (kebijakan dan edukasi)</strong>. Kombinasi keduanya sangat diperlukan untuk sistem mitigasi yang efektif.
            </div>

            <div class="simulation-area">
                <div class="interactive-note">
                    🎯 Klik setiap item mitigasi untuk mempelajari detail implementasinya dan mengapa itu penting.
                </div>
                
                <div class="mitigation-section">
                    <div class="mitigation-type">
                        <h3>🏗️ Mitigasi Struktural</h3>
                        <p style="margin-bottom: 20px;">Upaya teknis dengan pembangunan infrastruktur dan rekayasa fisik untuk mencegah, mendeteksi dini, atau membantu pemadaman kebakaran hutan.</p>
                        
                        <div class="mitigation-items">
                            <div class="mitigation-item" onclick="showMitigation('watchtower')">
                                <span class="icon">🔭</span>
                                <strong>Menara Pantau & Kamera</strong>
                                <p>Sistem pengawasan tinggi untuk deteksi dini asap/api.</p>
                            </div>
                            <div class="mitigation-item" onclick="showMitigation('firebreak-structure')">
                                <span class="icon">🛤️</span>
                                <strong>Jalur Sekat Api Permanen</strong>
                                <p>Pembangunan jalur kosong tanpa vegetasi sebagai pembatas.</p>
                            </div>
                            <div class="mitigation-item" onclick="showMitigation('alarm')">
                                <span class="icon">🔊</span>
                                <strong>Sistem Alarm Deteksi</strong>
                                <p>Sensor asap dan panas otomatis untuk respons cepat.</p>
                            </div>
                            <div class="mitigation-item" onclick="showMitigation('water-system')">
                                <span class="icon">💦</span>
                                <strong>Sistem Penyediaan Air</strong>
                                <p>Hidran, embung, dan reservoir air yang mudah diakses.</p>
                            </div>
                            <div class="mitigation-item" onclick="showMitigation('access-road')">
                                <span class="icon">🛣️</span>
                                <strong>Jalan Akses Darurat</strong>
                                <p>Infrastruktur jalan untuk kendaraan pemadam.</p>
                            </div>
                        </div>
                    </div>

                    <div class="mitigation-type" style="background: linear-gradient(135deg, #fd79a8, #e84393);">
                        <h3>📚 Mitigasi Non-Struktural</h3>
                        <p style="margin-bottom: 20px;">Mencakup upaya kebijakan, pendidikan, dan pemberdayaan masyarakat untuk mencegah dan mengurangi risiko kebakaran secara non-fisik.</p>
                        
                        <div class="mitigation-items">
                            <div class="mitigation-item" onclick="showMitigation('education')">
                                <span class="icon">👨‍🏫</span>
                                <strong>Edukasi Masyarakat</strong>
                                <p>Program penyuluhan dan peningkatan kesadaran publik.</p>
                            </div>
                            <div class="mitigation-item" onclick="showMitigation('regulation')">
                                <span class="icon">📋</span>
                                <strong>Peraturan & Penegakan Hukum</strong>
                                <p>Kebijakan tegas terhadap pembakaran lahan ilegal.</p>
                            </div>
                            <div class="mitigation-item" onclick="showMitigation('training')">
                                <span class="icon">💪</span>
                                <strong>Pelatihan Petugas & Relawan</strong>
                                <p>Peningkatan kapasitas SDM pemadam kebakaran dan relawan.</p>
                            </div>
                            <div class="mitigation-item" onclick="showMitigation('evacuation')">
                                <span class="icon">🚶</span>
                                <strong>Simulasi Evakuasi</strong>
                                <p>Latihan respons darurat dan evakuasi masyarakat.</p>
                            </div>
                            <div class="mitigation-item" onclick="showMitigation('community')">
                                <span class="icon">🤝</span>
                                <strong>Penguatan Kelompok Masyarakat</strong>
                                <p>Pembentukan kelompok peduli api (MPA) di desa.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="mitigationExplanation" class="info-text" style="display: none;">
                    <div id="mitigationContent"></div>
                </div>
            </div>

            <div class="success-text">
                <strong>Implementasi Mitigasi Terpadu:</strong><br>
                • <strong>Tahap Perencanaan:</strong> Analisis risiko, pemetaan area rawan, dan penyusunan rencana kontingensi.<br>
                • <strong>Tahap Pembangunan:</strong> Instalasi infrastruktur fisik, seperti menara pantau, sekat bakar, dan sistem hidran.<br>
                • <strong>Tahap Operasional:</strong> Melaksanakan program edukasi masyarakat, patroli hutan rutin, dan pelatihan petugas.<br>
                • <strong>Tahap Evaluasi:</strong> Monitoring efektivitas semua upaya mitigasi dan melakukan perbaikan berkelanjutan berdasarkan data dan pengalaman.
            </div>
        </div>

        <div class="panel" id="panel7">
            <h2>🌟 Panel 7: Rangkuman & Kesimpulan</h2>
            
            <div class="info-text">
                Pengelolaan kebakaran hutan yang efektif memerlukan pemahaman menyeluruh tentang penyebab, proses, dampak, dan upaya mitigasi. Melalui simulasi ini, kita telah menelusuri berbagai aspek penting dari fenomena kebakaran hutan. Berikut adalah perjalanan siklus kebakaran hutan dan pemulihannya.
            </div>

            <div class="simulation-area">
                <div class="interactive-note">
                    🔄 Siklus Kebakaran Hutan: Dari Bencana Menuju Pemulihan
                </div>
                
                <div class="recovery-timeline">
                    <div class="timeline-stage" onclick="showRecoveryStage('fire')">
                        <span class="icon">🔥</span>
                        <h4>Kebakaran</h4>
                        <p>Kerusakan Awal</p>
                    </div>
                    <div class="timeline-stage" onclick="showRecoveryStage('extinguish')">
                        <span class="icon">🚒</span>
                        <h4>Pemadaman</h4>
                        <p>Upaya Pengendalian</p>
                    </div>
                    <div class="timeline-stage" onclick="showRecoveryStage('recovery')">
                        <span class="icon">🌱</span>
                        <h4>Pemulihan</h4>
                        <p>Regenerasi Alami</p>
                    </div>
                    <div class="timeline-stage" onclick="showRecoveryStage('prevention')">
                        <span class="icon">🛡️</span>
                        <h4>Pencegahan</h4>
                        <p>Mitigasi Masa Depan</p>
                    </div>
                </div>

                <div id="recoveryExplanation" class="success-text" style="display: none;">
                    <div id="recoveryContent"></div>
                </div>
                <iframe width="560" height="315" src="https://www.youtube.com/embed/cMUnFyz_8mM" title="How Fire Can Restore a Forest: A Time-Lapse (Tree View)" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

            <div class="warning-text">
                <strong>Pesan Utama:</strong><br>
                Kebakaran hutan adalah fenomena kompleks yang membutuhkan pendekatan holistik dari berbagai pihak. <strong>Pencegahan selalu lebih baik dan lebih murah daripada pemadaman</strong>, dan pemulihan ekosistem memerlukan waktu yang sangat panjang. Peran setiap individu sangat penting dalam menjaga kelestarian hutan dan lingkungan.
            </div>

            <div class="info-text">
                <strong>Langkah Nyata yang Bisa Kita Lakukan:</strong><br>
                • <strong>Sebagai Individu:</strong> Jangan membuang puntung rokok sembarangan, pastikan api unggun padam sempurna, dan laporkan segera jika melihat titik api.<br>
                • <strong>Sebagai Komunitas:</strong> Berpartisipasi dalam kelompok peduli hutan, mendukung sosialisasi pencegahan kebakaran, dan membantu upaya patroli.<br>
                • <strong>Sebagai Pemerintah:</strong> Menegakkan regulasi yang ketat, membangun infrastruktur deteksi, melatih petugas dan relawan.<br>
                • <strong>Sebagai Industri/Bisnis:</strong> Menerapkan standar keselamatan yang tinggi dalam operasi mereka di dekat hutan, investasi teknologi pencegahan, dan turut serta dalam program reboisasi.
            </div>

            <div class="success-text">
                <strong>Kesimpulan:</strong><br>
                Hutan yang lestari adalah warisan berharga untuk generasi mendatang, terutama di wilayah seperti Bali yang sangat bergantung pada ekosistem alamnya. Dengan pemahaman yang baik tentang kebakaran hutan dan komitmen bersama dalam upaya mitigasi, kita dapat meminimalkan risiko dan dampak kebakaran hutan di masa depan.
            </div>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // --- Variabel Global dan Elemen UI ---
        let currentPanel = 1; // Panel yang sedang aktif
        let fireElements = { heat: true, fuel: true, oxygen: true }; // Status elemen segitiga api
        let forestCells = []; // Status sel di peta hutan (Panel 3)
        let fireIntensity = 100; // Intensitas api di Panel 5
        let spreadAnimation; // Interval animasi penyebaran api
        let fireStarted = false; // Status apakah api sudah dimulai di Panel 3

        const tooltipDiv = document.getElementById('tooltip');

        // Fungsi untuk menampilkan tooltip
        function showTooltip(event, text) {
            tooltipDiv.textContent = text;
            tooltipDiv.classList.add('show');
            // Posisi tooltip dekat dengan kursor
            tooltipDiv.style.left = `${event.clientX + 10}px`;
            tooltipDiv.style.top = `${event.clientY + 10}px`;
        }

        // Fungsi untuk menyembunyikan tooltip
        function hideTooltip() {
            tooltipDiv.classList.remove('show');
        }

        // --- Panel Navigation (Logika Tombol Navigasi) ---
        function showPanel(panelNumber) {
            // Sembunyikan semua panel
            document.querySelectorAll('.panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            // Hapus kelas 'active' dari semua tombol navigasi
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Tampilkan panel yang dipilih
            document.getElementById(`panel${panelNumber}`).classList.add('active');
            
            // Tambahkan kelas 'active' ke tombol yang diklik
            // Menggunakan event.currentTarget untuk mendapatkan tombol yang sebenarnya diklik
            const clickedButton = event.currentTarget;
            clickedButton.classList.add('active');
            
            currentPanel = panelNumber;

            // Inisialisasi atau reset simulasi spesifik saat panel diaktifkan
            if (panelNumber === 3) { // Panel Penyebaran Api
                initializeForest();
                updateFireSpread(); // Inisialisasi dan mulai penyebaran
                if (!fireStarted) { // Pastikan api hanya dimulai sekali atau setelah reset
                    fireStarted = true;
                }
            } else {
                // Hentikan animasi penyebaran api jika beralih dari panel 3
                clearInterval(spreadAnimation);
                fireStarted = false; // Reset status api
            }

            if (panelNumber === 5) { // Panel Pemadaman
                resetFire(); // Inisialisasi ulang api di panel pemadaman
            }

            // Atur ulang state Segitiga Api saat panel 1 aktif
            if (panelNumber === 1) {
                resetFireTriangle();
            }
        }

        // --- Panel 1: Segitiga Api Logic ---
        function toggleElement(element) {
            fireElements[element] = !fireElements[element];
            
            const fireCenter = document.getElementById('fireCenter');
            const explanation = document.getElementById('triangleExplanation');
            const removedElementSpan = document.getElementById('removedElement');
            
            // Perbarui status api
            const allElementsActive = fireElements.heat && fireElements.fuel && fireElements.oxygen;

            if (!allElementsActive) {
                fireCenter.classList.add('extinguished');
                fireCenter.innerHTML = '❌'; // Tampilan api padam
                explanation.style.display = 'block';
                
                let removed = [];
                if (!fireElements.heat) removed.push('Panas');
                if (!fireElements.fuel) removed.push('Bahan Bakar');
                if (!fireElements.oxygen) removed.push('Oksigen');
                
                removedElementSpan.textContent = removed.join(', ');
            } else {
                fireCenter.classList.remove('extinguished');
                fireCenter.innerHTML = '🔥'; // Tampilan api menyala
                explanation.style.display = 'none';
            }
            
            // Visual feedback untuk elemen yang diklik (opacity & transform)
            const elementDiv = document.querySelector(`.triangle-element.${element}`);
            if (fireElements[element]) {
                elementDiv.style.opacity = '1';
                elementDiv.style.transform = ''; // Hapus transform tambahan jika aktif
            } else {
                elementDiv.style.opacity = '0.3';
                elementDiv.style.transform = 'scale(0.9)'; // Sedikit menyusut saat tidak aktif
            }
        }

        // Reset Segitiga Api
        function resetFireTriangle() {
            fireElements = { heat: true, fuel: true, oxygen: true };
            const fireCenter = document.getElementById('fireCenter');
            fireCenter.classList.remove('extinguished');
            fireCenter.innerHTML = '�';
            document.getElementById('triangleExplanation').style.display = 'none';

            // Reset visual semua elemen
            document.querySelectorAll('.triangle-element').forEach(elem => {
                elem.style.opacity = '1';
                elem.style.transform = '';
            });
        }

        // Event listeners untuk tooltip pada Segitiga Api
        document.querySelectorAll('.triangle-element').forEach(element => {
            element.addEventListener('mouseover', (e) => showTooltip(e, element.dataset.tooltip));
            element.addEventListener('mousemove', (e) => showTooltip(e, element.dataset.tooltip)); // Update position
            element.addEventListener('mouseout', hideTooltip);
        });


        // --- Panel 2: Penyebab Kebakaran Logic ---
        const causesData = {
            lightning: {
                title: '⚡ Sambaran Petir',
                content: 'Petir dapat mencapai suhu hingga 30.000°C, lebih panas dari permukaan matahari. Ketika menyambar pohon atau vegetasi kering, petir dapat langsung memicu kebakaran. Ini adalah penyebab alami yang paling umum, terutama saat musim kemarau dengan aktivitas petir tinggi namun curah hujan rendah.'
            },
            cigarette: {
                title: '🚬 Puntung Rokok Sembarangan',
                content: 'Puntung rokok yang masih menyala dapat membakar rumput kering dan dedaunan dalam hitungan menit. Suhu ujung rokok mencapai 400-700°C, cukup panas untuk memicu pembakaran. Ini adalah salah satu penyebab kebakaran yang paling mudah dicegah dengan kesadaran masyarakat.'
            },
            campfire: {
                title: '🔥 Api Unggun Tak Diawasi',
                content: 'Api unggun yang tidak diawasi atau tidak dimatikan dengan benar dapat menyebar ke area sekitar. Angin dapat meniup percikan api hingga ratusan meter. Pembersihan area sekitar dan pemadaman total dengan air atau tanah adalah kunci pencegahan kebakaran dari api unggun.'
            },
            burning: {
                title: '🌾 Pembakaran Lahan',
                content: 'Praktik pembakaran lahan untuk membersihkan area pertanian atau perkebunan sering kali tidak terkendali. Api yang dimaksudkan untuk area kecil dapat menyebar ke hutan terdekat, terutama saat kondisi kering dan berangin. Ini adalah penyebab utama kebakaran hutan besar di Indonesia.'
            },
            electrical: {
                title: '🔌 Korsleting Listrik',
                content: 'Kabel listrik yang rusak, instalasi yang tidak memenuhi standar, atau bahkan trafo yang kepanasan dapat menyebabkan percikan api. Di area hutan wisata atau dekat pemukiman, korsleting pada infrastruktur listrik dapat memicu kebakaran besar yang sulit dikendalikan.'
            },
            vehicle: {
                title: '🚗 Kendaraan Panas / Percikan Api',
                content: 'Knalpot kendaraan atau mesin berat yang sangat panas dapat membakar rumput kering di bawahnya saat parkir atau melintas. Percikan api dari knalpot atau sistem pengereman yang rusak juga bisa menjadi pemicu. Penting untuk memastikan kendaraan dalam kondisi baik dan berhati-hati saat di area rawan.'
            }
        };

        function showCause(causeKey) {
            const explanation = document.getElementById('causeExplanation');
            const contentDiv = document.getElementById('causeContent');
            
            const data = causesData[causeKey];
            if (data) {
                contentDiv.innerHTML = `<strong>${data.title}</strong><br>${data.content}`;
                explanation.style.display = 'block';
            }
        }


        // --- Panel 3: Proses Penyebaran Api Logic ---
        let forestGridData = [];
        const GRID_SIZE = 15; // 15x15 grid
        const NEIGHBOR_PROB_BASE = 0.3; // Base probability for fire to spread to a healthy neighbor

        function initializeForest() {
            const forestGridElement = document.getElementById('forestGrid');
            forestGridElement.innerHTML = ''; // Clear existing grid
            forestGridData = [];

            for (let i = 0; i < GRID_SIZE * GRID_SIZE; i++) {
                const cell = document.createElement('div');
                cell.className = 'forest-cell';
                cell.dataset.index = i;
                forestGridElement.appendChild(cell);
                forestGridData.push('healthy');
            }
            
            // Start fire in the center
            const centerIndex = Math.floor(GRID_SIZE * GRID_SIZE / 2);
            forestGridData[centerIndex] = 'burning';
            document.querySelector(`#forestGrid [data-index="${centerIndex}"]`).classList.add('burning');
            
            fireStarted = true;
        }

        function updateFireSpread() {
            const windSpeedVal = parseInt(document.getElementById('windSpeed').value);
            const humidityVal = parseInt(document.getElementById('humidity').value);
            const temperatureVal = parseInt(document.getElementById('temperature').value);
            
            // Update display values
            document.getElementById('windValue').textContent = getWindDescription(windSpeedVal);
            document.getElementById('humidityValue').textContent = getHumidityDescription(humidityVal);
            document.getElementById('temperatureValue').textContent = getTemperatureDescription(temperatureVal);
            
            // Calculate combined spread factor (0-100)
            // Wind and Temp increase spread, Humidity decreases it
            const combinedFactor = (windSpeedVal + temperatureVal + (100 - humidityVal)) / 3;
            
            document.getElementById('spreadRate').textContent = getSpreadRate(combinedFactor);
            document.getElementById('spreadProgress').style.width = combinedFactor + '%';
            
            // Update wind arrow rotation (basic visual, not tied to spread direction logic)
            const windArrow = document.getElementById('windArrow');
            const rotation = (windSpeedVal / 100) * 360; // 0-360 deg based on speed
            windArrow.style.transform = `rotate(${rotation}deg)`;
            windArrow.style.opacity = windSpeedVal > 10 ? 1 : 0.3; // Hide if no wind

            // Update fire size indicator (based on combined factor)
            document.getElementById('fireSize').textContent = getFireSize(combinedFactor);
            
            // Restart fire spread animation with new speed
            if (fireStarted) {
                clearInterval(spreadAnimation);
                const animationSpeed = Math.max(50, 1000 - (combinedFactor * 8)); // Faster with higher factor
                spreadAnimation = setInterval(spreadFire, animationSpeed);
            }
        }

        function getWindDescription(value) {
            if (value < 30) return `Lemah (${value}%)`;
            if (value < 70) return `Sedang (${value}%)`;
            return `Kencang (${value}%)`;
        }

        function getHumidityDescription(value) {
            if (value < 30) return `Rendah (${value}%)`;
            if (value < 70) return `Normal (${value}%)`;
            return `Tinggi (${value}%)`;
        }

        function getTemperatureDescription(value) {
            const tempC = Math.round(20 + (value * 0.3)); // 0->20, 100->50
            if (tempC < 30) return `Sejuk (${tempC}°C)`;
            if (tempC < 40) return `Sedang (${tempC}°C)`;
            return `Panas (${tempC}°C)`;
        }

        function getSpreadRate(factor) {
            if (factor < 30) return 'Lambat';
            if (factor < 50) return 'Normal';
            if (factor < 70) return 'Cepat';
            return 'Sangat Cepat';
        }

        function getFireSize(factor) {
            if (factor < 30) return 'Kecil';
            if (factor < 50) return 'Sedang';
            if (factor < 70) return 'Besar';
            return 'Sangat Besar';
        }

        function spreadFire() {
            const burningCells = [];
            forestGridData.forEach((state, index) => {
                if (state === 'burning') {
                    burningCells.push(index);
                }
            });
            
            const nextForestGridData = [...forestGridData]; // Create a copy for next state

            burningCells.forEach(index => {
                // Current burning cell has a chance to turn to burnt
                if (Math.random() < 0.1) {
                    nextForestGridData[index] = 'burnt';
                    document.querySelector(`#forestGrid [data-index="${index}"]`).classList.remove('burning');
                    document.querySelector(`#forestGrid [data-index="${index}"]`).classList.add('burnt');
                }

                // Spread to adjacent healthy cells
                const neighbors = getNeighbors(index, GRID_SIZE);
                neighbors.forEach(neighborIndex => {
                    if (forestGridData[neighborIndex] === 'healthy') {
                        // Spread probability influenced by environment sliders
                        const windSpeedVal = parseInt(document.getElementById('windSpeed').value);
                        const humidityVal = parseInt(document.getElementById('humidity').value);
                        const temperatureVal = parseInt(document.getElementById('temperature').value);

                        let spreadProb = NEIGHBOR_PROB_BASE;

                        // Wind effect (simplified: higher speed increases spread overall)
                        spreadProb *= (1 + (windSpeedVal / 200)); // Max 1.5x base

                        // Humidity effect (lower humidity increases spread)
                        spreadProb *= (1 + (100 - humidityVal) / 200); // Max 1.5x base

                        // Temperature effect (higher temp increases spread)
                        spreadProb *= (1 + temperatureVal / 200); // Max 1.5x base

                        // Clamp probability
                        spreadProb = Math.min(1, Math.max(0.1, spreadProb));

                        if (Math.random() < spreadProb) {
                            nextForestGridData[neighborIndex] = 'burning';
                            document.querySelector(`#forestGrid [data-index="${neighborIndex}"]`).classList.add('burning');
                        }
                    }
                });
            });
            forestGridData = nextForestGridData;
        }

        function getNeighbors(index, gridSize) {
            const neighbors = [];
            const row = Math.floor(index / gridSize);
            const col = index % gridSize;
            
            // Check all 8 directions
            for (let r = -1; r <= 1; r++) {
                for (let c = -1; c <= 1; c++) {
                    if (r === 0 && c === 0) continue;
                    
                    const newRow = row + r;
                    const newCol = col + c;
                    
                    if (newRow >= 0 && newRow < gridSize && newCol >= 0 && newCol < gridSize) {
                        neighbors.push(newRow * gridSize + newCol);
                    }
                }
            }
            return neighbors;
        }

        function resetForest() {
            clearInterval(spreadAnimation);
            initializeForest();
            updateFireSpread(); // Apply current slider settings to new forest
        }


        // --- Panel 4: Dampak Kebakaran Logic ---
        const damagesData = {
            biodiversity: {
                title: '🦋 Kehilangan Keanekaragaman Hayati',
                content: 'Kebakaran hutan secara langsung menghancurkan habitat alami ribuan spesies flora dan fauna. Banyak hewan kecil dan tumbuhan yang tidak dapat melarikan diri atau beradaptasi akan mati. Ini menyebabkan kepunahan lokal dan mengurangi keanekaragaman genetik, memerlukan waktu puluhan hingga ratusan tahun untuk pemulihan.'
            },
            air: {
                title: '😷 Polusi Udara (Kabut Asap)',
                content: 'Asap dari kebakaran hutan mengandung partikel halus (PM2.5), karbon monoksida, nitrogen dioksida, dan berbagai senyawa organik berbahaya. Kabut asap ini dapat menyebar jauh melintasi batas wilayah, menyebabkan polusi udara yang parah dan mengurangi jarak pandang, mengganggu transportasi dan aktivitas sehari-hari.'
            },
            health: {
                title: '🏥 Masalah Kesehatan Serius',
                content: 'Paparan jangka pendek maupun panjang terhadap asap kebakaran dapat menyebabkan berbagai masalah kesehatan seperti Infeksi Saluran Pernapasan Akut (ISPA), iritasi mata, kulit, dan tenggorokan. Bagi kelompok rentan (anak-anak, lansia, penderita asma/jantung), dampaknya bisa sangat fatal.'
            },
            economic: {
                title: '💰 Kerugian Ekonomi Skala Besar',
                content: 'Kebakaran hutan menyebabkan kerugian ekonomi triliunan rupiah. Ini termasuk hilangnya sumber daya kayu dan non-kayu, biaya operasional pemadaman, gangguan pada sektor pertanian dan perkebunan, penurunan kunjungan wisatawan, serta kerusakan infrastruktur.'
            },
            climate: {
                title: '🌡️ Perubahan Iklim Global',
                content: 'Hutan bertindak sebagai paru-paru bumi dan penyerap karbon. Kebakaran hutan melepaskan sejumlah besar karbon dioksida dan gas rumah kaca lainnya ke atmosfer, mempercepat pemanasan global. Hilangnya hutan juga mengurangi kapasitas bumi untuk menyerap CO2 di masa depan.'
            },
            soil: {
                title: '🌱 Kerusakan Tanah & Erosi',
                content: 'Panas tinggi dari kebakaran dapat menghancurkan lapisan humus dan mikroorganisme di dalam tanah, mengurangi kesuburan dan kemampuan tanah menahan air. Tanah yang terbuka dan gersang pasca-kebakaran sangat rentan terhadap erosi oleh angin dan hujan, menyebabkan kerusakan jangka panjang pada ekosistem.'
            },
            regeneration: {
                title: '🌱 Regenerasi Tumbuhan Tertentu',
                content: 'Dalam beberapa ekosistem, panas dari api dapat memecah dormansi (tidur) benih-benih tertentu, memicu perkecambahan dan pertumbuhan generasi baru tumbuhan yang beradaptasi dengan api. Contohnya adalah pohon pinus atau spesies pionir lainnya.'
            },
            nutrients: {
                title: '🌿 Siklus Nutrisi & Penyuburan Tanah',
                content: 'Abu yang dihasilkan dari pembakaran vegetasi mengandung mineral dan nutrisi yang dapat kembali ke tanah, menyediakan pupuk alami untuk pertumbuhan tumbuhan baru. Namun, pada kebakaran intensitas tinggi atau lahan gambut, nutrisi ini bisa hilang akibat erosi atau menguap.'
            },
            diversity: {
                title: '🦎 Penciptaan Habitat Baru & Peningkatan Keanekaragaman',
                content: 'Meskipun menghancurkan habitat yang ada, kebakaran dapat menciptakan kondisi baru yang cocok untuk spesies lain yang membutuhkan ruang terbuka atau paparan sinar matahari lebih banyak. Ini dapat meningkatkan keanekaragaman hayati dalam jangka panjang di ekosistem yang secara alami terpapar api.'
            }
        };

        function showDamage(damageKey) {
            const explanation = document.getElementById('damageExplanation');
            const contentDiv = document.getElementById('damageContent');
            
            const data = damagesData[damageKey];
            if (data) {
                contentDiv.innerHTML = `<strong>${data.title}</strong><br>${data.content}`;
                explanation.style.display = 'block';
            }
        }


        // --- Panel 5: Cara Pemadaman Logic ---
        let fireIntensityValue = 100;
        let fireIntensityInterval;

        function updateFireIntensityDisplay() {
            document.getElementById('fireIntensityDisplay').textContent = `${fireIntensityValue.toFixed(0)}%`;
            document.getElementById('fireExtinguishProgress').style.width = `${fireIntensityValue}%`;
            if (fireIntensityValue <= 0) {
                clearInterval(fireIntensityInterval);
                document.getElementById('fireIntensityDisplay').textContent = `0% (Padam)`;
                showToolExplanation({
                    title: 'Api Telah Padam!',
                    content: 'Kerja bagus! Simulasi menunjukkan api berhasil dipadamkan. Ingatlah bahwa pemadaman di dunia nyata membutuhkan kerja keras dan bahaya yang luar biasa.'
                });
            } else if (fireIntensityValue > 0 && !fireIntensityInterval) {
                 // Restart decrease if it was paused or reset
                fireIntensityInterval = setInterval(() => {
                    fireIntensityValue = Math.max(0, fireIntensityValue - 0.5); // Api berkurang perlahan secara alami
                    updateFireIntensityDisplay();
                }, 200);
            }
        }

        const toolsData = {
            ground: {
                title: '🚒 Tim Darat (Petugas & Mobil Pemadam)',
                content: 'Tim darat adalah garda terdepan dalam pemadaman kebakaran. Mereka menggunakan selang air, alat manual (gepyok, garu), dan pompa untuk memadamkan api secara langsung. Efektif untuk api kecil hingga sedang, tetapi terbatas oleh medan dan akses.'
            },
            helicopter: {
                title: '🚁 Helikopter Water Bombing',
                content: 'Helikopter atau pesawat *water bombing* menjatuhkan air atau zat penekan api dari udara ke titik-titik api yang luas atau sulit dijangkau. Sangat efektif untuk memadamkan area yang luas dengan cepat, namun biayanya mahal dan tergantung kondisi cuaca.'
            },
            firebreak: {
                title: '🛤️ Pembuatan Sekat Bakar',
                content: 'Sekat bakar adalah jalur tanpa vegetasi yang dibuat di depan api untuk menghilangkan bahan bakar. Ini memaksa api untuk "kelaparan" dan berhenti menyebar. Dapat dibuat secara manual atau menggunakan alat berat. Merupakan metode pencegahan penyebaran yang sangat efektif.'
            },
            foam: {
                title: '🧴 Busa Pemadam (Foam)',
                content: 'Busa pemadam adalah agen pemadam api yang dicampur dengan air. Ketika disemprotkan, busa ini menciptakan lapisan yang mengisolasi api dari oksigen, sekaligus mendinginkan bahan bakar. Sangat efektif untuk api di permukaan dan di celah-celah.'
            },
            backburn: {
                title: '🔥 Pembakaran Terkendali (Backburn)',
                content: 'Ini adalah metode yang berisiko tinggi di mana api kecil sengaja dinyalakan di depan api utama (melawan arah angin) untuk membakar bahan bakar yang akan dilalui api utama. Tujuannya adalah menghilangkan bahan bakar di jalur api utama agar api utama tidak memiliki apa pun untuk dibakar dan padam. Membutuhkan perencanaan dan kontrol yang sangat cermat.'
            },
            chemical: {
                title: '💧 Retardant Kimia',
                content: 'Retardant adalah bahan kimia yang dicampur dengan air dan dijatuhkan dari udara atau disemprotkan di darat. Bahan ini bekerja dengan memperlambat atau menghambat proses pembakaran. Sering digunakan untuk menciptakan garis pertahanan kimia di jalur penyebaran api.'
            }
        };

        function useFireTool(toolKey) {
            const toolEffect = {
                ground: 20, // Mengurangi 20% intensitas
                helicopter: 35, // Mengurangi 35% intensitas
                firebreak: 50, // Sekat bakar mengurangi banyak karena menghambat penyebaran
                foam: 25,
                backburn: 40, // Berisiko tapi efektif
                chemical: 30
            };
            
            fireIntensityValue = Math.max(0, fireIntensityValue - toolEffect[toolKey]);
            updateFireIntensityDisplay();
            showToolExplanation(toolsData[toolKey]);
        }

        function resetFire() {
            fireIntensityValue = 100;
            updateFireIntensityDisplay();
            document.getElementById('toolExplanation').style.display = 'none';
        }

        function showToolExplanation(data) {
            const explanation = document.getElementById('toolExplanation');
            const contentDiv = document.getElementById('toolContent');
            contentDiv.innerHTML = `<strong>${data.title}</strong><br>${data.content}`;
            explanation.style.display = 'block';
        }


        // --- Panel 6: Mitigasi Logic ---
        const mitigationDetails = {
            'watchtower': {
                title: 'Menara Pantau & Kamera',
                content: 'Menara pantau strategis yang dilengkapi dengan kamera pengawas (bahkan thermal imaging) memungkinkan pemantauan area hutan secara luas. Ini krusial untuk deteksi dini asap atau titik api kecil, sehingga respons pemadaman dapat dilakukan lebih cepat sebelum api meluas.',
                image: 'assets/gif/watchtower_monitoring.gif'
            },
            'firebreak-structure': {
                title: 'Jalur Sekat Api Permanen',
                content: 'Pembangunan jalur atau area bebas vegetasi (misalnya jalan, kanal) secara permanen di dalam atau di sekitar hutan. Jalur ini berfungsi sebagai penghalang fisik yang menghentikan penyebaran api karena tidak ada bahan bakar di jalur tersebut. Sangat efektif sebagai garis pertahanan.'
            },
            'alarm': {
                title: 'Sistem Alarm Deteksi Asap',
                content: 'Penggunaan sensor asap dan panas otomatis yang dipasang di titik-titik rawan dalam hutan atau dekat pemukiman. Sistem ini dapat memberikan peringatan dini secara otomatis ke pusat kontrol, mempercepat waktu respons pemadam kebakaran.'
            },
            'water-system': {
                title: 'Sistem Penyediaan Air Buatan',
                content: 'Pembangunan embung, waduk kecil, sumur bor, atau instalasi hidran di dalam atau di tepi hutan. Tujuannya adalah menyediakan sumber air yang mudah dan cepat diakses oleh tim pemadam kebakaran, terutama di area yang jauh dari sumber air alami.'
            },
            'access-road': {
                title: 'Jalan Akses Darurat',
                content: 'Pembangunan dan pemeliharaan jalan atau jalur khusus di dalam dan sekitar kawasan hutan. Jalan ini memudahkan akses kendaraan pemadam kebakaran dan personel ke titik api dengan cepat, mengurangi waktu respons yang kritis.'
            },
            'education': {
                title: 'Edukasi Masyarakat',
                content: 'Program penyuluhan dan kampanye kesadaran publik kepada masyarakat sekitar hutan tentang bahaya kebakaran, penyebab umum yang disebabkan manusia, dan praktik pencegahan yang aman (misalnya, tidak membakar sampah, memadamkan puntung rokok). Ini mengubah perilaku dan mengurangi risiko.'
            },
            'regulation': {
                title: 'Peraturan & Penegakan Hukum',
                content: 'Pembuatan dan penegakan peraturan yang ketat terkait larangan pembakaran lahan secara ilegal. Ini termasuk sanksi hukum yang berat bagi pelaku pembakaran hutan. Penegakan hukum yang kuat memberikan efek jera dan mengurangi insiden kebakaran yang disengaja.'
            },
            'training': {
                title: 'Pelatihan Petugas & Relawan',
                content: 'Peningkatan kapasitas dan keterampilan petugas pemadam kebakaran, polisi hutan, serta relawan masyarakat (misalnya Manggala Agni, Masyarakat Peduli Api). Pelatihan ini meliputi teknik pemadaman, deteksi dini, dan penanganan kondisi darurat kebakaran.'
            },
            'evacuation': {
                title: 'Simulasi Evakuasi',
                content: 'Melaksanakan latihan dan simulasi evakuasi secara berkala di komunitas yang tinggal dekat hutan. Ini bertujuan untuk melatih masyarakat tentang rute evakuasi, titik kumpul aman, dan prosedur darurat jika terjadi kebakaran hutan. Meningkatkan kesiapsiagaan dan mengurangi korban jiwa.'
            },
            'community': {
                title: 'Penguatan Kelompok Masyarakat Peduli Api (MPA)',
                content: 'Membentuk dan memberdayakan kelompok-kelompok masyarakat lokal yang secara sukarela terlibat dalam patroli hutan, deteksi dini, pemadaman awal skala kecil, dan sosialisasi kepada warga. Mereka adalah garda terdepan pencegahan di tingkat tapak.'
            }
        };

        function showMitigation(mitigationKey) {
            const explanation = document.getElementById('mitigationExplanation');
            const contentDiv = document.getElementById('mitigationContent');
            
            const data = mitigationDetails[mitigationKey];
            if (data) {
                contentDiv.innerHTML = `<strong>${data.title}</strong><br>${data.content}`;
                if (data.image) {
                    contentDiv.innerHTML += `<img src="${data.image}" alt="${data.title}" style="max-width:100%; height:auto; margin-top:15px; border-radius:8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">`;
                }
                explanation.style.display = 'block';
            }
        }

        // --- Panel 7: Rangkuman Logic ---
        const recoveryStages = {
            fire: {
                title: '🔥 Tahap Kebakaran',
                content: 'Pada tahap ini, api aktif membakar vegetasi dan merusak ekosistem. Ini adalah fase paling berbahaya yang membutuhkan respons pemadaman segera dan terkoordinasi untuk meminimalkan kerugian.'
            },
            extinguish: {
                title: '🚒 Tahap Pemadaman',
                content: 'Fase di mana upaya aktif dilakukan untuk mengendalikan dan memadamkan api. Melibatkan tim darat, serangan udara, dan pembentukan sekat bakar. Tujuannya adalah mengisolasi api dan mendinginkan area yang terbakar.'
            },
            recovery: {
                title: '🌱 Tahap Pemulihan',
                content: 'Setelah api padam, hutan memasuki fase pemulihan. Awalnya terlihat gersang dan rusak, namun perlahan-lahan benih berkecambah, tumbuhan pionir tumbuh, dan satwa kembali. Proses ini bisa memakan waktu puluhan hingga ratusan tahun.'
            },
            prevention: {
                title: '🛡️ Tahap Pencegahan & Mitigasi',
                content: 'Ini adalah tahap berkelanjutan di mana pelajaran dari kebakaran sebelumnya diterapkan. Dilakukan pembangunan infrastruktur mitigasi, edukasi masyarakat, patroli rutin, dan penegakan hukum untuk mencegah kebakaran serupa di masa depan.'
            }
        };

        function showRecoveryStage(stageKey) {
            const explanation = document.getElementById('recoveryExplanation');
            const contentDiv = document.getElementById('recoveryContent');
            
            const data = recoveryStages[stageKey];
            if (data) {
                contentDiv.innerHTML = `<strong>${data.title}</strong><br>${data.content}`;
                explanation.style.display = 'block';
            }
        }

        // --- Initial setup on page load ---
        document.addEventListener('DOMContentLoaded', () => {
            // Initial call to show the first panel and setup its content
            // The showPanel function will handle the initial active state for nav-btn
            // No need to explicitly call showPanel(1) here as the HTML already has 'active' class
            // Just ensure initial fire spread animation is off until panel 3 is shown
            clearInterval(spreadAnimation);
            fireStarted = false;

            // Set up initial state for Panel 3 sliders
            updateFireSpread(); // This will also initialize wind arrow and fire size indicator

            // Set up initial state for Panel 5 fire intensity
            updateFireIntensityDisplay();
        });
    </script>
</body>
</html>